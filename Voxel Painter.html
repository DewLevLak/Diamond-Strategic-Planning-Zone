<!DOCTYPE html>
<html lang="en">
<head>
    <title>three.js canvas - interactive - voxel painter</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <style>
        body {
            font-family: Monospace;
            background-color: #f0f0f0;
            margin: 0px;
            overflow: hidden;
        }
    </style>
</head>
<body>

    <script src="js/Three.js"></script>
    <script src="js/Detector.js"></script>     <!--used to detect if browser is three.js compatable-->
    <!--<script src="js/Stats.js"></script>-->
    <script src="js/libs/stats.min.js"></script>    <!--display resource statistics-->
    <script src="js/OrbitControls.js"></script>    <!--mouse controls to orbit screen-->
    <script src="js/THREEx.KeyboardState.js"></script>    <!--listen to keyboard changes-->
    <script src="js/THREEx.FullScreen.js"></script>
    <script src="js/THREEx.WindowResize.js"></script>    <!--listen for window size change-->
    <!--<script type='text/javascript' src='js/DAT.GUI.min.js'></script>-->    <!--display GUI control panel-->

    <script src="js/renderers/Projector.js"></script>
    <script src="js/renderers/CanvasRenderer.js"></script>

    <script type='text/javascript' src='js/DAT.GUI.min.js'></script>    <!--display GUI control panel-->
    <!-- jQuery code to display an information button and box when clicked. -->
    <script src="js/jquery-1.9.1.js"></script>
    <script src="js/jquery-ui.js"></script>
    <script src="js/bitset.js"></script>   <!--https://github.com/infusion/BitSet.js?files=1-->
    <!--<script src="js/bitset.min.js"></script>-->   <!--https://github.com/infusion/BitSet.js?files=1-->

    <script>

        if (!Detector.webgl) Detector.addGetWebGLMessage();
        // standard global variables
        var keyboard = new THREEx.KeyboardState();
        //var clock = new THREE.Clock();
        var container, scene, camera, renderer, controls, stats;    // div container/gui controls/resource stats
        var group = new THREE.Group();
        var camToSave = {};
        var mouse, orbitControls, raycaster, isCTRLDown = false, isShiftDown = false; //controls and selection

        // custom global variables
        //r gui = new dat.GUI();
        var parameters; //paramerters of the gui
        var blockSize = 10 // change block size
        var planeWidth = 1000, planeDepth = 1000;
        var plane;  // main level plateform
        var stencilMesh, stencilMaterial;
        var stencilGroup = new THREE.Object3D();

        var cubeGeometry = new THREE.BoxBufferGeometry(blockSize, blockSize, blockSize);
        var cubeMaterial = new THREE.MeshLambertMaterial({ color: 0x00ff00, transparent: true, opacity: 0.0625, overdraw: 0.5 }); //0x00ff80, 0xf0f0f5
        var cubeMaterial2 = new THREE.MeshLambertMaterial({ color: 0xff0000, transparent: false, opacity: 1, overdraw: 0.5 }); //0x00ff80, 0x00ff00
        var voxel = new THREE.Mesh(cubeGeometry, cubeMaterial);
        //var voxel2 = new THREE.Mesh(cubeGeometry, cubeMaterial2);

        var objects = [];
        var days = [];
        var rooms = []; // contain levels rooms
        var textGroup;
        var loader = new THREE.FontLoader();

        //var level1 = [];
        var posSetter;
        //https://github.com/infusion/BitSet.js?files=1
        //http://monmohan.github.io/dsjslib/BitSet.js.html
        //https://www.npmjs.com/package/bit-set-js

        var dayRangeHeight = 288; //     60 min / 5 min * 24 hours = 288 (day in 5 min increments)




        loader.load('fonts/helvetiker_regular.typeface.json', function (font) {
            init(font);
            render();
        });

        //init();
        //render();

        function init(font) {
            //create and layout div
            container = document.createElement('div');
            document.body.appendChild(container);

            var info = document.createElement('div');
            info.style.position = 'absolute';
            info.style.top = '10px';
            info.style.width = '100%';
            info.style.textAlign = 'center';
            info.innerHTML = 'Room Selection:<br><strong>CTRL + click</strong>: Place Room Marker, <strong>shift + click</strong>: Remove Room Marker</a>';
            container.appendChild(info);

            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setPixelRatio(window.devicePixelRatio);
            renderer.setSize(window.innerWidth, window.innerHeight);
            container.appendChild(renderer.domElement);

            // STATS
            stats = new Stats();
            stats.domElement.style.position = 'absolute';
            stats.domElement.style.bottom = '0px';
            stats.domElement.style.zIndex = 100;
            container.appendChild(stats.domElement);

            //camera
            camera = new THREE.PerspectiveCamera(40, window.innerWidth / window.innerHeight, 1, 10000);
            camera.position.set(500, 800, 1600);
            camera.lookAt(new THREE.Vector3());

            scene = new THREE.Scene();


            scene.background = new THREE.Color(0xa3e6ff);

            for (i = 0; i < 8; i++) {
                for (j = 0; j < dayRangeHeight; j++) {
                    stencilGeo = new THREE.BoxBufferGeometry(blockSize, blockSize, blockSize);
                    stencilMaterial = new THREE.MeshBasicMaterial({ color: 0xf0f0f5, opacity: 0.5, transparent: true }); //0xff0000, 0x00ff00
                    stencilMesh = new THREE.Mesh(stencilGeo, stencilMaterial);
                    stencilMesh.position.set(((-3 * i) * (blockSize / 3)), j, 0);
                    stencilGroup.add(stencilMesh);
                }
            }
            stencilGroup.visible = false;
            scene.add(stencilGroup);
            //scene.add(stencilMesh);



            //
            raycaster = new THREE.Raycaster();
            mouse = new THREE.Vector2();

            var geometry = new THREE.PlaneBufferGeometry(planeWidth, planeDepth);
            geometry.rotateX(- Math.PI / 2);

            //plane = new THREE.Mesh(geometry, new THREE.MeshBasicMaterial({ visible: true }));

            texture = new THREE.TextureLoader().load('img/floor1.jpg');

            //texture = THREE.TextureLoader().load('img/floor1.jpg');
            material = new THREE.MeshBasicMaterial({ map: texture });
            plane = new THREE.Mesh(geometry, material);

            scene.add(plane);

            objects.push(plane);

            material = new THREE.MeshBasicMaterial({ color: 0xff0000, wireframe: true });

            // Lights

            var ambientLight = new THREE.AmbientLight(0x606060);
            scene.add(ambientLight);

            var directionalLight = new THREE.DirectionalLight(0xffffff);
            directionalLight.position.x = Math.random() - 0.5;
            directionalLight.position.y = Math.random() - 0.5;
            directionalLight.position.z = Math.random() - 0.5;
            directionalLight.position.normalize();
            scene.add(directionalLight);

            var directionalLight = new THREE.DirectionalLight(0x808080);
            directionalLight.position.x = Math.random() - 0.5;
            directionalLight.position.y = Math.random() - 0.5;
            directionalLight.position.z = Math.random() - 0.5;
            directionalLight.position.normalize();
            scene.add(directionalLight);


            ////////////////////TEXT///////////////////////
            // Get text from hash
            var theText = "Building Empire - LL 1";
            var hash = document.location.hash.substr(1);

            if (hash.length !== 0) {
                theText = hash;
            }

            var textGeometry = new THREE.TextGeometry(theText, {
                font: font,
                size: 30,
                height: 10,
                curveSegments: 2

            });

            textGeometry.computeBoundingBox();

            var centerOffset = -0.5 * (textGeometry.boundingBox.max.x - textGeometry.boundingBox.min.x);

            var textMaterials = [
                //new THREE.MeshBasicMaterial({ color: Math.random() * 0xffffff, overdraw: 0.5 }),
                new THREE.MeshBasicMaterial({ color: 0xffcc00, overdraw: 0.5 }),
                new THREE.MeshBasicMaterial({ color: 0x000000, overdraw: 0.5 })
            ];

            var textMesh = new THREE.Mesh(textGeometry, textMaterials);

            textMesh.position.x = centerOffset;
            textMesh.position.y = -100;
            textMesh.position.z = planeDepth / 2;

            textMesh.rotation.x = 0;
            textMesh.rotation.y = Math.PI * 2;

            textGroup = new THREE.Group();
            textGroup.add(textMesh);
            scene.add(textGroup);
            ////////////////////TEXT///////////////////////


            ////////////////////GUI///////////////////////
            parameters =
                {
                    //x: 0, y: 30, z: 0,
                    //color: "#ff0000", // color (change "#" to "0x")
                    //opacity: 1,
                    //visible: true,
                    //material: "Phong",
                    blockSize: 10,
                    planeWidth: 1000,
                    planeDepth: 1000,
                    resetCube: function () { resetCube() },
                    resetCamera: function () { resetCamera() }
                };

            //var planeWidth = gui.add(parameters, 'planeWidth').min(50).max(1000).step(50).listen();
            //planeWidth.onChange(function (value) {
            //    plane.scale.x = value;
            //    //objects.forEach(function (element) {
            //    //    if (element != plane) {
            //    //        element.scale.x = value/2;
            //    //    }
            //    //});
            //});
            //var planeDepth = gui.add(parameters, 'planeDepth').min(50).max(1000).step(50).listen();
            //planeDepth.onChange(function (value) {
            //    plane.scale.z = value/2;
            //});

            //var blockSize = gui.add(parameters, 'blockSize').min(1).max(10).step(1).listen();
            //blockSize.onChange(function (value) {
            //    objects.forEach(function (element) {
            //        if (element != plane) {
            //            element.scale.x = value;
            //            element.scale.y = value/4;
            //            element.scale.z = value;
            //        }
            //        });
            //    });



            ////gui.add(parameters, 'resetCamera').name("Reset Camera");
            ////gui.add(parameters, 'resetCube').name("Reset Cube Parameters");

            //gui.open();



            ////////////////////GUI//////////////////////


            render();


            document.addEventListener('mousemove', onDocumentMouseMove, false);
            document.addEventListener('mousedown', onDocumentMouseDown, false);
            document.addEventListener('keydown', onDocumentKeyDown, false);
            document.addEventListener('keyup', onDocumentKeyUp, false);


            orbitControls = new THREE.OrbitControls(camera, renderer.domElement);

            window.addEventListener('resize', onWindowResize, false);

        }

        function onWindowResize() {

            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();

            renderer.setSize(window.innerWidth, window.innerHeight);

            render();

        }

        function onDocumentMouseMove(event) {

            event.preventDefault();

            mouse.set((event.clientX / window.innerWidth) * 2 - 1, - (event.clientY / window.innerHeight) * 2 + 1);

            raycaster.setFromCamera(mouse, camera);

            var intersects = raycaster.intersectObjects(objects);

            if (intersects.length > 0) {

                var intersect = intersects[0];
                stencilGroup.position.copy(intersect.point).add(intersect.face.normal);
                stencilGroup.position.divideScalar(blockSize).floor().multiplyScalar(blockSize).addScalar(blockSize / 2);
            }

            render();

        }


        // example from game https://icecreamyou.github.io/Nemesis/
        //var ai = [];
        //var aiGeo = new t.CubeGeometry(40, 40, 40);
        //function setupAI() {
        //    for (var i = 0; i < NUMAI; i++) {
        //        addAI();
        //    }
        //}

        //function addAI() {
        //    var c = getMapSector(cam.position);
        //    var aiMaterial = new t.MeshBasicMaterial({/*color: 0xEE3333,*/map: t.ImageUtils.loadTexture('images/face.png') });
        //    var o = new t.Mesh(aiGeo, aiMaterial);
        //    do {
        //        var x = getRandBetween(0, mapW - 1);
        //        var z = getRandBetween(0, mapH - 1);
        //    } while (map[x][z] > 0 || (x == c.x && z == c.z));
        //    x = Math.floor(x - mapW / 2) * UNITSIZE;
        //    z = Math.floor(z - mapW / 2) * UNITSIZE;
        //    o.position.set(x, UNITSIZE * 0.15, z);
        //    o.health = 100;
        //    //o.path = getAIpath(o);
        //    o.pathPos = 1;
        //    o.lastRandomX = Math.random();
        //    o.lastRandomZ = Math.random();
        //    o.lastShot = Date.now(); // Higher-fidelity timers aren't a big deal here.
        //    ai.push(o);
        //    scene.add(o);
        //}
        //////////function addRoom(name, theX, theY, theZ) {

        //////////    var room = new Room(name, theX, theY, theZ);
        //////////    return room
        //////////}

        //////////function Room(theName, theX, theY, theZ) {
        //////////    this.name = theName;
        //////////    this.x = theX;
        //////////    this.y = theY;
        //////////    this.z = theZ;
        //////////    this.weekDays = new Week(theX, theY, theZ);
        //////////}

        //////////function Week(theX, theY, theZ) {
        //////////    var weekGroup = new THREE.Group();
        //////////    this.sunday = new Day("sunday", theX + ((-3 * 6) * (blockSize / 3)), theY, theZ);
        //////////    weekGroup.add(sunday);
        //////////    this.monday = new Day("monday", theX + ((-3 * 5) * (blockSize / 3)), theY, theZ);
        //////////    weekGroup.add(monday);
        //////////    this.tuesday = new Day("tuesday", theX + ((-3 * 4) * (blockSize / 3)), theY, theZ);
        //////////    weekGroup.add(tuesday);
        //////////    this.wednesday = new Day("wednesday", theX + ((-3 * 3) * (blockSize / 3)), theY, theZ);
        //////////    weekGroup.add(wednesday);
        //////////    this.thursday = new Day("thursday", theX + ((-3 * 2) * (blockSize / 3)), theY, theZ);
        //////////    weekGroup.add(thursday);
        //////////    this.friday = new Day("friday", theX + ((-3) * (blockSize / 3)), theY, theZ);
        //////////    weekGroup.add(friday);
        //////////    this.saturday = new Day("saturday", theX, theY, theZ);
        //////////    weekGroup.add(saturday);

        //////////    weekGroup.position.copy(theX, theY, theZ).add(intersect.face.normal);
        //////////    weekGroup.position.divideScalar(blockSize).floor().multiplyScalar(blockSize).addScalar(blockSize / 2);
        //////////    scene.add(weekGroup);
        //////////    objects.push(weekGroup);
        //////////    return weekGroup;
        //////////}

        //////////function Day(name, theX, theY, theZ) {
        //////////    var dayGroup = new THREE.Group();
        //////////    this.name = name;
        //////////    //this.schedule = [0x00000000, 0x00000000, 0x00000000, 0x00000fff, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000];
        //////////    //var count = 0;
        //////////    //schedule.foreach(function (element) {
        //////////    //    var theBool = 0x80000000;

        //////////    //    for (i = 0; i < 32; i++) {

        //////////    //        var result = theBool & element;
        //////////            var timeBlock = new THREE.Mesh(cubeGeometry, cubeMaterial);
        //////////            //if (result != 0) {
        //////////            //        timeBlock.color = 0xff0000;
        //////////            //        timeBlock.transparent = false;
        //////////            //        timeBlock.opacity = 1;
        //////////            //}
        //////////            timeBlock.position.set(theX, theY, theZ); //theY + count

        //////////            //scene.add(timeBlock);
        //////////            dayGroup.add(timeBlock);
        //////////            //theBool >> 1;
        //////////            objects.push(timeBlock);
        //////////            //count++;
        //////////        //}
        //////////    //});

        //////////    dayGroup.position.copy(theX, theY, theZ).add(intersect.face.normal);
        //////////    dayGroup.position.divideScalar(blockSize).floor().multiplyScalar(blockSize).addScalar(blockSize / 2);
        //////////    //scene.add(dayGroup);
        //////////    objects.push(dayGroup);
        //////////    return dayGroup;
        //////////}
        //function addRoom(name) {//name, theIntersect, cubeGeometry, cubeMaterial, blockSize) {
        //    var room = new Room(name);
        //    return room
        //}

        function addRoom(theName, intersect) {
            //this.schedule = [0x00000000, 0x00000000, 0x00000000, 0x00000fff, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000];
            //var sunday = new Array(288).fill(false);
            //var monday = new Array(288).fill(false);
            //var tuesday = new Array(288).fill(true);
            //var wednesday = new Array(288).fill(false);
            //var thursday = new Array(288).fill(true);
            //var friday = new Array(288).fill(false);
            //var saturday = new Array(288).fill(false);

            //this.schedule = new Array(sunday, monday, tuesday, wednesday, thursday, friday, saturday);
            this.weekGroup = new Week();

            //for each (var day in weekGroup.children){
            //    for each (var block in day.children){

            //    }
            //}
            //weekGroup.dayGroup.voxel[1];
            weekGroup.name = theName;
            weekGroup.intersect = intersect;
            weekGroup.position.copy(intersect.point).add(intersect.face.normal);
            scene.add(weekGroup);
        }
        //integer = time / 12:05 am
        //0	    11  	12:01	am  	12:59	am
        //12	23	    1:01	am  	1:59	am
        //24	35	    2:01	am  	2:59	am
        //36	47	    3:01	am	    3:59	am
        //48	59	    4:01	am	    4:59	am
        //60	71	    5:01	am	    5:59	am
        //72	83  	6:01	am	    6:59	am
        //84	95  	7:01	am	    7:59	am
        //96	107 	8:01	am	    8:59	am
        //108	119 	9:01	am	    9:59	am
        //120	131	    10:01	am	    10:59	am
        //132	143 	11:01	am	    11:59	pm
        //144	155	    12:01	pm  	12:59	pm
        //156	167	    1:01	pm	    1:59	pm
        //168	179 	2:01	pm	    2:59	pm
        //180	191 	3:01	pm	    3:59	pm
        //192	203 	4:01	pm	    4:59	pm
        //204	215 	5:01	pm	    5:59	pm
        //216	227	    6:01	pm  	6:59	pm
        //228	239 	7:01	pm  	7:59	pm
        //240	251	    8:01	pm  	8:59	pm
        //252	263 	9:01	pm  	9:59	pm
        //264	275	    10:01	pm  	10:59	pm
        //276	287	    11:01	pm  	11:59	am

        BitSet.fromHexString(str)




        function Week() {
            var timePeriod = new date("12:05 am");
            var startTime = new Date("8:30 am");
            var endTime = new Date("10:20 am");
            //var startNum = startTime / timePeriod;
           // var endNum = endTime / timePeriod;



            console.log(startTime);// + " - " + endNum);
            var schedule = [];
            var sunday = new BitSet();
            //sunday.setRange(0, 288, 0);
             //sunday.setRange(165, 200, 1);
            sunday = BitSet.fromBinaryString("0b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
                "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
                "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000");
            schedule.push(sunday);
            var monday = new BitSet();
            //monday.setRange(0, 288, 0);
            //monday.setRange(125, 138, 1);
            monday = BitSet.fromBinaryString("0b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
                "111111111111111111111111111111111111111111111111111111111111111100000000000000000000000000000000" +
                "111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000");
            schedule.push(monday);
            var tuesday = new BitSet();
            //tuesday.setRange(0, 288, 0);
            //tuesday.setRange(165, 200, 1);
            tuesday = BitSet.fromBinaryString("0b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
                "000000000000000000000000000000111111111111000000000000000000000000000000000000000000000000000000" +
                "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000");
            schedule.push(tuesday);
            var wednesday = new BitSet();
           // wednesday.setRange(0, 288, 0);
            //wednesday.setRange(125, 138, 1);
            wednesday = BitSet.fromBinaryString("0b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
                "111111111111111111111111111111111111111111111111111111111111111100000000000000000000000000000000" +
                "111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000");
            schedule.push(wednesday);
            var thursday = new BitSet();
           // thursday.setRange(0, 288, 0);
            //thursday.setRange(165, 200, 1);
            thursday = BitSet.fromBinaryString("0b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
                "000000000000000000000000000000111111111111000000000000000000000000000000000000000000000000000000" +
                "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000");
            schedule.push(thursday);
            var friday = new BitSet();
            //friday.setRange(0, 288, 0);
            //friday.setRange(125, 138, 1);
            friday = BitSet.fromBinaryString("0b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
                "111111111111111111111111111111111111111111111111111111111111111100000000000000000000000000000000" +
                "111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000");
            schedule.push(friday);
            var saturday = new BitSet();
            //saturday.setRange(0, 288, 0);
            //saturday.setRange(165, 200, 1);
            saturday = BitSet.fromBinaryString("0b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
                "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
                "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000");
            schedule.push(saturday);
            //var pig = sunday.toString();
            //alert(pig)
            //var schedule = new Array(sunday, monday, tuesday, wednesday, thursday, friday, saturday);

            var week = new THREE.Object3D();
            for (i = 0; i < 7; i++) {
                //var dayGroup = new Day();
                var day = new THREE.Object3D();

                for (j = 0; j < dayRangeHeight; j++) {
                    if (schedule[i].get(j)) {
                        var voxel = new THREE.Mesh(cubeGeometry, cubeMaterial2);
                        voxel.position.set(0, j, 0);
                        //////if (j == 170) {
                        //////    var pig = schedule[i].get(170);
                        //////    alert(pig)
                        //////}
                        //objects.push(voxel);
                        //var poke = pig.get(j);
                        //voxel.setColor = function (taken) {
                        //alert("yes");


                        // voxel.material = cubeMaterial2

                        //voxel.material.color.setHex(0xff0000);
                        //voxel.material.transparent = false;
                        //voxel.material.opacity = 1;
                        //sphere.material.color.setHex( value.replace("#", "0x") );
                    } else {
                        var voxel = new THREE.Mesh(cubeGeometry, cubeMaterial);
                        voxel.position.set(0, j, 0);
                        //voxel.material.color.setHex(0x00ff00);
                        //voxel.material.setColor = 0x00ff00;
                        //voxel.material.transparent = true;
                        //voxel.material.opacity = 0.0625;
                    }

                    day.add(voxel);
                    //voxel.geometry.elementsNeedUpdate = true;
                    //}
                }

                day.position.set(((-3 * i) * (blockSize / 3)), 1, 0);

                day.position.divideScalar(blockSize).floor().multiplyScalar(blockSize).addScalar(blockSize / 2);
                week.add(day);
                days.push(day);
            }

            return week;
        }

        function Day(name) {

            return day;
        }





        function onDocumentMouseDown(event) {

            event.preventDefault();

            mouse.set((event.clientX / window.innerWidth) * 2 - 1, - (event.clientY / window.innerHeight) * 2 + 1);

            //mouse.x = (event.clientX / renderer.domElement.clientWidth) * 2 - 1;
            //mouse.y = - (event.clientY / renderer.domElement.clientHeight) * 2 + 1;

            raycaster.setFromCamera(mouse, camera);

            var intersects = raycaster.intersectObjects(objects);
            //var intersects = raycaster.intersectObjects(objects.children, true);

            if (intersects.length > 0) {

                var intersect = intersects[0];
                //var intersect = intersects[0].object.parent
                if (isShiftDown) {

                    if (intersect.object != plane) {

                        scene.remove(intersect.object.parent);

                        objects.splice(objects.indexOf(intersect.object.parent), 1);

                    }

                }

                else if (isCTRLDown) {

                    isCTRLDown = false;
                    stencilGroup.visible = false;
                    orbitControls.enable = false;
                    var text = prompt("Enter a new room number", "rm#");
                    if (text) {
                        var room = addRoom(text, intersect);

                        rooms.push(room);


                        //room.weekGroup.position.copy(room.intersect.point).add(intersect.face.normal);
                        //room.weekGroup.position.divideScalar(blockSize).floor().multiplyScalar(blockSize).addScalar(blockSize / 2);
                        //scene.add(room.weekGroup);
                        //objects.push(room.weekGroup);


                        //var sunday = [0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0xc0000000, 0x00000000, 0x00000000, 0x00000000];
                        //var monday = [0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x000003ff, 0xc0000000, 0x00000000, 0x00000000, 0x00000000];
                        //var tuesday = [0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x000003ff, 0xc0000000, 0x00000000, 0x00000000, 0x00000000];
                        //var wednesday = [0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x000003ff, 0xc0000000, 0x00000000, 0x00000000, 0x00000000];
                        //var thrusday = [0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x000003ff, 0xc0000000, 0x00000000, 0x00000000, 0x00000000];
                        //var friday = [0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x000003ff, 0xc0000000, 0x00000000, 0x00000000, 0x00000000];
                        //var saturday = [0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0xc0000000, 0x00000000, 0x00000000, 0x00000000];

                        //room.weekDays = new Week(sunday, monday, tuesday, wednesday, thursday, friday, saturday);

                        //var group = new THREE.Group();
                        //room.week.forEach(function (day, d) {
                        //    room.week.day.forEach(function (timeBlock, p) {

                        //    });

                        //});


                        // set up objects
                        //var platforms = [
                        //    { x: 5.5, y: 0, z: 1, rope: 0, width: 5, depth: 10 }, // just above ground level
                        //    { x: 8.5, y: 10, z: -8.5, rope: 0, width: 4, depth: 3 }, // isolated
                        //    { x: 5, y: 19, z: 8, rope: 15, width: 4, depth: 4 },
                        //    { x: -6, y: 25, z: 8, rope: 0, width: 8, depth: 2 }, // no rope
                        //    { x: 4, y: 38, z: 5, rope: 25, width: 10, depth: 4 }, // WIDE
                        //    { x: 6, y: 60, z: 8, rope: 15, width: 4, depth: 4 },
                        //    { x: 9, y: 50, z: 8, rope: 15, width: 2, depth: 4 },
                        //    { x: 9, y: 51, z: 3, rope: 0, width: 2, depth: 2 }, // staircase
                        //    { x: 6, y: 52, z: 0, rope: 0, width: 2, depth: 2 }, // staircase
                        //    { x: 3, y: 53, z: -2, rope: 0, width: 2, depth: 2 }, // staircase
                        //    { x: 0, y: 54, z: -2, rope: 0, width: 2, depth: 2 }, // staircase
                        //    { x: -3, y: 55, z: 0, rope: 0, width: 2, depth: 2 }, // staircase
                        //    { x: -3, y: 55, z: 0, rope: 0, width: 2, depth: 2 }, // staircase
                        //    { x: -9, y: 50, z: 5, rope: 20, width: 2, depth: 10 }, // isolated
                        //    { x: -4, y: 70, z: -4, rope: 15, width: 12, depth: 11 }, // rope = deadend, big platform
                        //    { x: -8, y: 75, z: 9, rope: 20, width: 2, depth: 2 }, //
                        //    { x: -9, y: 72, z: 6, rope: 10, width: 2, depth: 2 }, //
                        //    { x: 5, y: 74, z: -6, rope: 0, width: 2, depth: 2 }, // climbing
                        //    { x: 9, y: 77, z: -2.5, rope: 0, width: 2, depth: 15 }, // climbing
                        //    { x: 7, y: 80, z: 8, rope: 0, width: 4, depth: 4 }, // climbing
                        //    { x: -6, y: 80, z: -2, rope: 0, width: 4, depth: 4 }, // jumping
                        //    { x: 4, y: 84, z: -8, rope: 0, width: 4, depth: 4 }, // jumping
                        //    { x: -8, y: 87, z: -7.5, rope: 0, width: 4, depth: 3 }, // jumping
                        //    { x: 3, y: 90, z: -4, rope: 0, width: 4, depth: 4 }, // jumping
                        //    { x: -8, y: 93, z: 2.5, rope: 0, width: 4, depth: 3 }, // jumping
                        //    { x: 3, y: 96, z: -6, rope: 0, width: 4, depth: 4 }, // jumping
                        //    { x: -8, y: 99, z: -5.5, rope: 0, width: 4, depth: 3 }, // jumping
                        //    { x: 0.5, y: 219, z: 0, rope: 115, width: 2, depth: 4 }
                        //];

                        stencilGroup.visible = false;
                        orbitControls.enable = true;
                    } else {
                        if (intersect.object != plane) {

                            intersects.object.setColor(0x1A75FF);
                        }
                    }


                }
                render();

            }

        }

        function onDocumentKeyDown(event) {
            //alert(event.keyCode);
            switch (event.keyCode) {
                case 27: isCTRLDown = false; stencilGroup.visible = false; break;
                case 16: isShiftDown = true; break;
                case 17: isCTRLDown = true; stencilGroup.visible = true; break;

            }

            render();
        }

        function onDocumentKeyUp(event) {

            switch (event.keyCode) {
                case 16: isShiftDown = false; stencilGroup.visible = false; break;
                case 17: isCTRLDown = false; break;

            }
        }

        function save() {

            window.open(renderer.domElement.toDataURL('image/png'), 'mywindow');
            return false;

        }

        function render() {
            renderer.render(scene, camera);
            stats.update();
        }

    </script>

</body>
</html>








<!--<script>-->
<!--if (!Detector.webgl) Detector.addGetWebGLMessage();
// standard global variables
var keyboard = new THREEx.KeyboardState();
//var clock = new THREE.Clock();
var container, scene, camera, renderer, controls, stats;    // div container/gui controls/resource stats

var group = new THREE.Group();
var camToSave = {};
var mouse, orbitControls, raycaster, isCTRLDown = false, isShiftDown = false; //controls and selection

// custom global variables
//r gui = new dat.GUI();
var parameters; //paramerters of the gui
var blockSize = 10 // change block size
var planeWidth = 1000, planeDepth = 1000;
var plane;  // main level plateform
var stencilMesh, stencilMaterial;
var stencilGroup = new THREE.Object3D();

var cubeGeometry = new THREE.BoxBufferGeometry(blockSize, blockSize, blockSize);
var cubeMaterial = new THREE.MeshLambertMaterial({ color: 0x00ff00, transparent: true, opacity: 0.0625, overdraw: 0.5 }); //0x00ff80, 0xf0f0f5
//var cubeMaterial2 = new THREE.MeshLambertMaterial({ color: 0xff0000, transparent: false, opacity: 1, overdraw: 0.5 }); //0x00ff80, 0x00ff00
var voxel = new THREE.Mesh(cubeGeometry, cubeMaterial);
//var voxel2 = new THREE.Mesh(cubeGeometry, cubeMaterial2);

var objects = [];
var rooms = []; // contain levels rooms
var textGroup;
var loader = new THREE.FontLoader();

//var level1 = [];
var posSetter;
//https://github.com/infusion/BitSet.js?files=1
//http://monmohan.github.io/dsjslib/BitSet.js.html
//https://www.npmjs.com/package/bit-set-js

var dayRangeHeight = 288; //     60 min / 5 min * 24 hours = 288 (day in 5 min increments)




loader.load('fonts/helvetiker_regular.typeface.json', function (font) {
    init(font);
    render();
});

//init();
//render();

function init(font) {
    //create and layout div
    container = document.createElement('div');
    document.body.appendChild(container);

    var info = document.createElement('div');
    info.style.position = 'absolute';
    info.style.top = '10px';
    info.style.width = '100%';
    info.style.textAlign = 'center';
    info.innerHTML = 'Room Selection:<br><strong>CTRL + click</strong>: Place Room Marker, <strong>shift + click</strong>: Remove Room Marker</a>';
    container.appendChild(info);

    renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setPixelRatio(window.devicePixelRatio);
    renderer.setSize(window.innerWidth, window.innerHeight);
    container.appendChild(renderer.domElement);

    // STATS
    stats = new Stats();
    stats.domElement.style.position = 'absolute';
    stats.domElement.style.bottom = '0px';
    stats.domElement.style.zIndex = 100;
    container.appendChild(stats.domElement);

    //camera
    camera = new THREE.PerspectiveCamera(40, window.innerWidth / window.innerHeight, 1, 10000);
    camera.position.set(500, 800, 1600);
    camera.lookAt(new THREE.Vector3());

    scene = new THREE.Scene();


    scene.background = new THREE.Color(0xa3e6ff);

    for (i = 0; i < 8; i++) {
        for (j = 0; j < dayRangeHeight; j++) {
            stencilGeo = new THREE.BoxBufferGeometry(blockSize, blockSize, blockSize);
            stencilMaterial = new THREE.MeshBasicMaterial({ color: 0xf0f0f5, opacity: 0.5, transparent: true }); //0xff0000, 0x00ff00
            stencilMesh = new THREE.Mesh(stencilGeo, stencilMaterial);
            stencilMesh.position.set(((-3 * i) * (blockSize / 3)), j, 0);
            stencilGroup.add(stencilMesh);
        }
    }
    stencilGroup.visible = false;
    scene.add(stencilGroup);
    //scene.add(stencilMesh);



    //
    raycaster = new THREE.Raycaster();
    mouse = new THREE.Vector2();

    var geometry = new THREE.PlaneBufferGeometry(planeWidth, planeDepth);
    geometry.rotateX(- Math.PI / 2);

    //plane = new THREE.Mesh(geometry, new THREE.MeshBasicMaterial({ visible: true }));

    texture = new THREE.TextureLoader().load('img/floor1.jpg');

    //texture = THREE.TextureLoader().load('img/floor1.jpg');
    material = new THREE.MeshBasicMaterial({ map: texture });
    plane = new THREE.Mesh(geometry, material);

    scene.add(plane);

    objects.push(plane);

    material = new THREE.MeshBasicMaterial({ color: 0xff0000, wireframe: true });

    // Lights

    var ambientLight = new THREE.AmbientLight(0x606060);
    scene.add(ambientLight);

    var directionalLight = new THREE.DirectionalLight(0xffffff);
    directionalLight.position.x = Math.random() - 0.5;
    directionalLight.position.y = Math.random() - 0.5;
    directionalLight.position.z = Math.random() - 0.5;
    directionalLight.position.normalize();
    scene.add(directionalLight);

    var directionalLight = new THREE.DirectionalLight(0x808080);
    directionalLight.position.x = Math.random() - 0.5;
    directionalLight.position.y = Math.random() - 0.5;
    directionalLight.position.z = Math.random() - 0.5;
    directionalLight.position.normalize();
    scene.add(directionalLight);


    ////////////////////TEXT///////////////////////
    // Get text from hash
    var theText = "Building Empire - LL 1";
    var hash = document.location.hash.substr(1);

    if (hash.length !== 0) {
        theText = hash;
    }

    var textGeometry = new THREE.TextGeometry(theText, {
        font: font,
        size: 30,
        height: 10,
        curveSegments: 2

    });

    textGeometry.computeBoundingBox();

    var centerOffset = -0.5 * (textGeometry.boundingBox.max.x - textGeometry.boundingBox.min.x);

    var textMaterials = [
        //new THREE.MeshBasicMaterial({ color: Math.random() * 0xffffff, overdraw: 0.5 }),
        new THREE.MeshBasicMaterial({ color: 0xffcc00, overdraw: 0.5 }),
        new THREE.MeshBasicMaterial({ color: 0x000000, overdraw: 0.5 })
    ];

    var textMesh = new THREE.Mesh(textGeometry, textMaterials);

    textMesh.position.x = centerOffset;
    textMesh.position.y = -100;
    textMesh.position.z = planeDepth / 2;

    textMesh.rotation.x = 0;
    textMesh.rotation.y = Math.PI * 2;

    textGroup = new THREE.Group();
    textGroup.add(textMesh);
    scene.add(textGroup);
    ////////////////////TEXT///////////////////////


    ////////////////////GUI///////////////////////
    parameters =
        {
            //x: 0, y: 30, z: 0,
            //color: "#ff0000", // color (change "#" to "0x")
            //opacity: 1,
            //visible: true,
            //material: "Phong",
            blockSize: 10,
            planeWidth: 1000,
            planeDepth: 1000,
            resetCube: function () { resetCube() },
            resetCamera: function () { resetCamera() }
        };

    //var planeWidth = gui.add(parameters, 'planeWidth').min(50).max(1000).step(50).listen();
    //planeWidth.onChange(function (value) {
    //    plane.scale.x = value;
    //    //objects.forEach(function (element) {
    //    //    if (element != plane) {
    //    //        element.scale.x = value/2;
    //    //    }
    //    //});
    //});
    //var planeDepth = gui.add(parameters, 'planeDepth').min(50).max(1000).step(50).listen();
    //planeDepth.onChange(function (value) {
    //    plane.scale.z = value/2;
    //});

    //var blockSize = gui.add(parameters, 'blockSize').min(1).max(10).step(1).listen();
    //blockSize.onChange(function (value) {
    //    objects.forEach(function (element) {
    //        if (element != plane) {
    //            element.scale.x = value;
    //            element.scale.y = value/4;
    //            element.scale.z = value;
    //        }
    //        });
    //    });



    ////gui.add(parameters, 'resetCamera').name("Reset Camera");
    ////gui.add(parameters, 'resetCube').name("Reset Cube Parameters");

    //gui.open();



    ////////////////////GUI//////////////////////


    render();


    document.addEventListener('mousemove', onDocumentMouseMove, false);
    document.addEventListener('mousedown', onDocumentMouseDown, false);
    document.addEventListener('keydown', onDocumentKeyDown, false);
    document.addEventListener('keyup', onDocumentKeyUp, false);


    orbitControls = new THREE.OrbitControls(camera, renderer.domElement);

    window.addEventListener('resize', onWindowResize, false);

}

function onWindowResize() {

    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();

    renderer.setSize(window.innerWidth, window.innerHeight);

    render();

}

function onDocumentMouseMove(event) {

    event.preventDefault();

    mouse.set((event.clientX / window.innerWidth) * 2 - 1, - (event.clientY / window.innerHeight) * 2 + 1);

    raycaster.setFromCamera(mouse, camera);

    var intersects = raycaster.intersectObjects(objects);

    if (intersects.length > 0) {

        var intersect = intersects[0];

        //stencilMesh.position.copy(intersect.point).add(intersect.face.normal);
        stencilGroup.position.copy(intersect.point).add(intersect.face.normal);
        //stencilMesh.position.divideScalar(blockSize).floor().multiplyScalar(blockSize).addScalar(blockSize / 2);
        stencilGroup.position.divideScalar(blockSize).floor().multiplyScalar(blockSize).addScalar(blockSize / 2);
    }

    render();

}


// example from game https://icecreamyou.github.io/Nemesis/
//var ai = [];
//var aiGeo = new t.CubeGeometry(40, 40, 40);
//function setupAI() {
//    for (var i = 0; i < NUMAI; i++) {
//        addAI();
//    }
//}

//function addAI() {
//    var c = getMapSector(cam.position);
//    var aiMaterial = new t.MeshBasicMaterial({/*color: 0xEE3333,*/map: t.ImageUtils.loadTexture('images/face.png') });
//    var o = new t.Mesh(aiGeo, aiMaterial);
//    do {
//        var x = getRandBetween(0, mapW - 1);
//        var z = getRandBetween(0, mapH - 1);
//    } while (map[x][z] > 0 || (x == c.x && z == c.z));
//    x = Math.floor(x - mapW / 2) * UNITSIZE;
//    z = Math.floor(z - mapW / 2) * UNITSIZE;
//    o.position.set(x, UNITSIZE * 0.15, z);
//    o.health = 100;
//    //o.path = getAIpath(o);
//    o.pathPos = 1;
//    o.lastRandomX = Math.random();
//    o.lastRandomZ = Math.random();
//    o.lastShot = Date.now(); // Higher-fidelity timers aren't a big deal here.
//    ai.push(o);
//    scene.add(o);
//}
//////////function addRoom(name, theX, theY, theZ) {

//////////    var room = new Room(name, theX, theY, theZ);
//////////    return room
//////////}

//////////function Room(theName, theX, theY, theZ) {
//////////    this.name = theName;
//////////    this.x = theX;
//////////    this.y = theY;
//////////    this.z = theZ;
//////////    this.weekDays = new Week(theX, theY, theZ);
//////////}

//////////function Week(theX, theY, theZ) {
//////////    var weekGroup = new THREE.Group();
//////////    this.sunday = new Day("sunday", theX + ((-3 * 6) * (blockSize / 3)), theY, theZ);
//////////    weekGroup.add(sunday);
//////////    this.monday = new Day("monday", theX + ((-3 * 5) * (blockSize / 3)), theY, theZ);
//////////    weekGroup.add(monday);
//////////    this.tuesday = new Day("tuesday", theX + ((-3 * 4) * (blockSize / 3)), theY, theZ);
//////////    weekGroup.add(tuesday);
//////////    this.wednesday = new Day("wednesday", theX + ((-3 * 3) * (blockSize / 3)), theY, theZ);
//////////    weekGroup.add(wednesday);
//////////    this.thursday = new Day("thursday", theX + ((-3 * 2) * (blockSize / 3)), theY, theZ);
//////////    weekGroup.add(thursday);
//////////    this.friday = new Day("friday", theX + ((-3) * (blockSize / 3)), theY, theZ);
//////////    weekGroup.add(friday);
//////////    this.saturday = new Day("saturday", theX, theY, theZ);
//////////    weekGroup.add(saturday);

//////////    weekGroup.position.copy(theX, theY, theZ).add(intersect.face.normal);
//////////    weekGroup.position.divideScalar(blockSize).floor().multiplyScalar(blockSize).addScalar(blockSize / 2);
//////////    scene.add(weekGroup);
//////////    objects.push(weekGroup);
//////////    return weekGroup;
//////////}

//////////function Day(name, theX, theY, theZ) {
//////////    var dayGroup = new THREE.Group();
//////////    this.name = name;
//////////    //this.schedule = [0x00000000, 0x00000000, 0x00000000, 0x00000fff, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000];
//////////    //var count = 0;
//////////    //schedule.foreach(function (element) {
//////////    //    var theBool = 0x80000000;

//////////    //    for (i = 0; i < 32; i++) {

//////////    //        var result = theBool & element;
//////////            var timeBlock = new THREE.Mesh(cubeGeometry, cubeMaterial);
//////////            //if (result != 0) {
//////////            //        timeBlock.color = 0xff0000;
//////////            //        timeBlock.transparent = false;
//////////            //        timeBlock.opacity = 1;
//////////            //}
//////////            timeBlock.position.set(theX, theY, theZ); //theY + count

//////////            //scene.add(timeBlock);
//////////            dayGroup.add(timeBlock);
//////////            //theBool >> 1;
//////////            objects.push(timeBlock);
//////////            //count++;
//////////        //}
//////////    //});

//////////    dayGroup.position.copy(theX, theY, theZ).add(intersect.face.normal);
//////////    dayGroup.position.divideScalar(blockSize).floor().multiplyScalar(blockSize).addScalar(blockSize / 2);
//////////    //scene.add(dayGroup);
//////////    objects.push(dayGroup);
//////////    return dayGroup;
//////////}
function addRoom() {//name, theIntersect, cubeGeometry, cubeMaterial, blockSize) {
    var group = new THREE.Group();


    //var room = new Room(name, theIntersect, cubeGeometry, cubeMaterial, blockSize);
    return group
}

function Room(theName, theIntersect, cubeGeometry, cubeMaterial, blockSize) {
    this.name = theName;

}

function Week(theX, theY, theZ) {

}

function Day(name, theX, theY, theZ) {

}





function onDocumentMouseDown(event) {

    event.preventDefault();

    mouse.set((event.clientX / window.innerWidth) * 2 - 1, - (event.clientY / window.innerHeight) * 2 + 1);

    //mouse.x = (event.clientX / renderer.domElement.clientWidth) * 2 - 1;
    //mouse.y = - (event.clientY / renderer.domElement.clientHeight) * 2 + 1;

    raycaster.setFromCamera(mouse, camera);

    var intersects = raycaster.intersectObjects(objects);
    //var intersects = raycaster.intersectObjects(objects.children, true);

    if (intersects.length > 0) {

        var intersect = intersects[0];
        //var intersect = intersects[0].object.parent
        if (isShiftDown) {

            if (intersect.object != plane) {

                scene.remove(intersect.object.parent);

                objects.splice(objects.indexOf(intersect.object.parent), 1);

            }

        }

        else if (isCTRLDown) {

            isCTRLDown = false;
            stencilGroup.visible = false;
            orbitControls.enable = false;
            var text = prompt("Enter a new room number", "rm#");
            if (text) {
                var group = addRoom();



                group.position.copy(intersect.point).add(intersect.face.normal);
                group.position.divideScalar(blockSize).floor().multiplyScalar(blockSize).addScalar(blockSize / 2);
                scene.add(group);
                objects.push(group);


                //var sunday = [0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0xc0000000, 0x00000000, 0x00000000, 0x00000000];
                //var monday = [0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x000003ff, 0xc0000000, 0x00000000, 0x00000000, 0x00000000];
                //var tuesday = [0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x000003ff, 0xc0000000, 0x00000000, 0x00000000, 0x00000000];
                //var wednesday = [0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x000003ff, 0xc0000000, 0x00000000, 0x00000000, 0x00000000];
                //var thrusday = [0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x000003ff, 0xc0000000, 0x00000000, 0x00000000, 0x00000000];
                //var friday = [0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x000003ff, 0xc0000000, 0x00000000, 0x00000000, 0x00000000];
                //var saturday = [0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0xc0000000, 0x00000000, 0x00000000, 0x00000000];

                //room.weekDays = new Week(sunday, monday, tuesday, wednesday, thursday, friday, saturday);
                level1.push(room);

                //var group = new THREE.Group();
                //room.week.forEach(function (day, d) {
                //    room.week.day.forEach(function (timeBlock, p) {

                //    });

                //});


                //Monday
                //00000000 00000000 00000000 00000000 000003ff c0000000 00000000 00000000 00000000
                //00000000000000000000000000000000 00000000000000000000000000000000 00000000000000000000000000000000
                //00000000000000000000000000000000 00000000000000000000001111111111 11000000000000000000000000000000
                //00000000000000000000000000000000 00000000000000000000000000000000 00000000000000000000000000000000
                //Tuesday
                //00000000 00000000 0000003f ffffffff ffffffff 00000000 00000000 00000000 00000000
                //00000000000000000000000000000000 00000000000000000000000000000000 00000000000000000000000000111111
                //11111111111111111111111111111111 11111111111111111111111111111111 00000000000000000000000000000000
                //00000000000000000000000000000000 00000000000000000000000000000000 00000000000000000000000000000000
                //
                //Wednesday
                //00000000 00000000 00000000 00000000 000003ff c0000000 00000000 00000000 00000000
                //00000000000000000000000000000000 00000000000000000000000000000000 00000000000000000000000000000000
                //00000000000000000000000000000000 00000000000000000000001111111111 11000000000000000000000000000000
                //00000000000000000000000000000000 00000000000000000000000000000000 00000000000000000000000000000000
                //
                //Thursday
                //00000000 00000000 0000003f ffffffff ffffffff 00000000 00000000 00000000 00000000
                //00000000000000000000000000000000 00000000000000000000000000000000 00000000000000000000000000111111
                //11111111111111111111111111111111 11111111111111111111111111111111 00000000000000000000000000000000
                //00000000000000000000000000000000 00000000000000000000000000000000 00000000000000000000000000000000
                //
                //Friday
                //00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
                //00000000000000000000000000000000 00000000000000000000000000000000 00000000000000000000000000000000
                //00000000000000000000000000000000 00000000000000000000000000000000 00000000000000000000000000000000
                //00000000000000000000000000000000 00000000000000000000000000000000 00000000000000000000000000000000
                //
                //Saturday
                //00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
                //var bar = parseInt(monday[4], 10).toString(2);
                //var num = parseInt(bar,10).tostring(2);
                //alert(bar);
                //var daySchedule

                //for (i = 0; i < room.weekDays.length; i++) {

                //    room.week.day.forEach(function (day) {
                //    for (i = 0; i < day.length; i++) {
                //        daySchedule += daySchedule.concat(parseInt(timeBlock, 10).tostring(2));
                //    }

                //    for (j = 0; j < daySchedule.length; j++) {
                //        if (daySchedule[j]) {
                //            var voxel = new THREE.Mesh(cubeGeometry, cubeMaterial);
                //        }
                //        else {
                //            var voxel = new THREE.Mesh(cubeGeometry, cubeMaterial2);
                //        }
                //    }
                //}

                //for (i = 0; i < room.weekDays.length; i++) {
                //    for (j = 0; j < room.weekDays.saturday.length; j++) {
                //        if (j > 175) {

                //            var voxel = new THREE.Mesh(cubeGeometry, cubeMaterial2);
                //        }
                //        else {
                //            var voxel = new THREE.Mesh(cubeGeometry, cubeMaterial);
                //        }
                //        voxel.position.set(((-3 * i) * (blockSize / 3)), j, 0);
                //        group.add(voxel);
                //        objects.push(voxel);
                //    }
                //}

                //for (i = 0; i < 8; i++) {
                //    for (j = 0; j < dayRangeHeight; j++) {
                //        if (j > 175) {

                //            var voxel = new THREE.Mesh(cubeGeometry, cubeMaterial2);
                //        }
                //        else {
                //            var voxel = new THREE.Mesh(cubeGeometry, cubeMaterial);
                //        }
                //        voxel.position.set(((-3 * i) * (blockSize / 3)), j, 0);
                //        group.add(voxel);
                //        objects.push(voxel);
                //    }
                //}
                //group.position.copy(intersect.point).add(intersect.face.normal);
                //group.position.divideScalar(blockSize).floor().multiplyScalar(blockSize).addScalar(blockSize / 2);
                //scene.add(group);
                //objects.push(group);

                //var voxel = new THREE.Mesh(cubeGeometry, cubeMaterial);//var pig = day.indexOf
                //voxel.position.copy(intersect.point).add(intersect.face.normal);
                //voxel.position.divideScalar(blockSize).floor().multiplyScalar(blockSize).addScalar(blockSize / 2);
                //scene.add(voxel);
                ////objects.push(voxel);
                stencilGroup.visible = false;
                orbitControls.enable = true;
            }



        }
        render();

    }

}

function onDocumentKeyDown(event) {
    //alert(event.keyCode);
    switch (event.keyCode) {
        case 27: isCTRLDown = false; stencilGroup.visible = false; break;
        case 16: isShiftDown = true; break;
        case 17: isCTRLDown = true; stencilGroup.visible = true; break;

    }

    render();
}

function onDocumentKeyUp(event) {

    switch (event.keyCode) {
        case 16: isShiftDown = false; stencilGroup.visible = false; break;
        case 17: isCTRLDown = false; break;

    }
}

function save() {

    window.open(renderer.domElement.toDataURL('image/png'), 'mywindow');
    return false;

}

function render() {
    renderer.render(scene, camera);
    stats.update();
}


                                                //function animate() {
                                                //    requestAnimationFrame(animate);
                                                //    render();
                                                //    update();
                                                //}

                                                //function update() {
                                                //    //if (keyboard.pressed("z")) {
                                                //    //    // do something
                                                //    //}
                                                //    //orbitControls.update();

                                                //    //stats.update();
                                                //}


                                                //function updateCube() {
                                                //    var value = parameters.material;
                                                //    var newMaterial;
                                                //    if (value == "Basic")
                                                //        newMaterial = new THREE.MeshBasicMaterial({ color: 0x000000 });
                                                //    else if (value == "Lambert")
                                                //        newMaterial = new THREE.MeshLambertMaterial({ color: 0x000000 });
                                                //    else if (value == "Phong")
                                                //        newMaterial = new THREE.MeshPhongMaterial({ color: 0x000000 });
                                                //    else // (value == "Wireframe")
                                                //        newMaterial = new THREE.MeshBasicMaterial({ wireframe: true });
                                                //    cube.material = newMaterial;

                                                //    cube.position.x = parameters.x;
                                                //    cube.position.y = parameters.y;
                                                //    cube.position.z = parameters.z;
                                                //    cube.material.color.setHex(parameters.color.replace("#", "0x"));
                                                //    cube.material.opacity = parameters.opacity;
                                                //    cube.material.transparent = true;
                                                //    cube.visible = parameters.visible;

                                                //}


                                                //function resetCube() {
                                                //    //parameters.x = 0;
                                                //    //parameters.y = 30;
                                                //    //parameters.z = 0;
                                                //    //parameters.color = "#ff0000";
                                                //    //parameters.opacity = 1;
                                                //    //parameters.visible = true;
                                                //    //parameters.material = "Phong";
                                                //    //parameters.blockSize = 20;
                                                //    //parameters.planeWidth = 1000;
                                                //    //parameters.planeDepth = 1000;
                                                //    //updateCube();
                                                //}


                                                //function resetCamera() {
                                                //    // CAMERA
                                                //    //var SCREEN_WIDTH = window.innerWidth, SCREEN_HEIGHT = window.innerHeight;
                                                //    //var VIEW_ANGLE = 45, ASPECT = SCREEN_WIDTH / SCREEN_HEIGHT, NEAR = 0.1, FAR = 20000;
                                                //    //camera = new THREE.PerspectiveCamera(VIEW_ANGLE, ASPECT, NEAR, FAR);
                                                //    //camera.position.set(2 * xMax, 0.5 * yMax, 4 * zMax);
                                                //    //camera.up = new THREE.Vector3(0, 0, 1);
                                                //    //camera.lookAt(scene.position);
                                                //    //camera = new THREE.PerspectiveCamera(40, window.innerWidth / window.innerHeight, 1, 10000);
                                                //    //camera.position.set(500, 800, 1600);
                                                //    //camera.lookAt(new THREE.Vector3());
                                                //    //scene.add(camera);

                                                //    //controls = new THREE.TrackballControls(camera, renderer.domElement);
                                                //    //THREEx.WindowResize(renderer, camera);
                                                //}-->
<!--</script>

</body>
</html>-->
